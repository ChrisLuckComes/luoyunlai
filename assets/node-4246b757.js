import{j as e,d as s,e as l}from"./index-12c11ae8.js";import{U as r}from"./useMarkdown-141d10e7.js";import{A as n}from"./Anchor-cb8b8329.js";const d="/luoyunlai/assets/nodeModel-42166b9a.png",o="/luoyunlai/assets/libuv-321bdb36.webp",a="/luoyunlai/assets/brainless-f6e04f2a.webp",t="/luoyunlai/assets/flow-ebe50d62.png",h=`\`\`\`sql
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€>           timers          
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚     pending callbacks     
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚       idle, prepare       
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   incoming:   â”‚
â”‚  â”‚           poll                                        <â”€â”€â”€â”¤  connections, â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   data, etc.  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”‚           check           
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€      close callbacks      
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
\`\`\``,j=`\`\`\`ts
const fs = require('fs');

function someAsyncOperation(callback) {
  // å‡è®¾è¯»å–æ–‡ä»¶éœ€è¦95ms
  fs.readFile('/path/to/file', callback);
}

const timeoutScheduled = Date.now();

setTimeout(() => {
  const delay = Date.now() - timeoutScheduled;

  console.log(delay + 'ms have passed since I was scheduled');
}, 100);

// æ‰§è¡Œå‡½æ•°
someAsyncOperation(() => {
  const startCallback = Date.now();

  // ç©ºè¿‡ï¼Œè€—æ—¶10ms
  while (Date.now() - startCallback < 10) {

  }
});
\`\`\``;function p(){const i=e.jsx(r,{markdown:h}),c=e.jsx(r,{markdown:j});return e.jsxs("article",{id:"rootArticle",className:s.article,children:[e.jsxs("main",{className:s.content,children:[e.jsx("h2",{id:"intro",className:"font-semibold text-h2 mb-2",children:"Node.js"}),"ä»€ä¹ˆæ˜¯Node.js?å®˜ç½‘ä¸€å¥è¯ä»‹ç»ï¼šNode.jsæ˜¯ä¸€ä¸ªå¼€æºï¼Œè·¨å¹³å°çš„JavaScriptè¿è¡Œæ—¶ç¯å¢ƒã€‚",e.jsx("div",{className:s.assist,children:"Node.jsÂ® is an open-source, cross-platform JavaScript runtime environment."}),e.jsx("br",{}),"Node.jsåŸºäºV8å¼•æ“è¿è¡Œï¼Œè„±ç¦»äº†æµè§ˆå™¨ï¼Œå› æ­¤å¯ä»¥èƒœä»»ä»»æ„ç±»å‹çš„é¡¹ç›®ã€‚Node.js appå•è¿›ç¨‹è¿è¡Œï¼Œä¸éœ€è¦å¯¹æ¯ä¸€ä¸ªè¯·æ±‚éƒ½åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼ŒåŸç”Ÿæä¾›äº†å¼‚æ­¥çš„I/Oè®¾ç½®ä»¥é˜²æ­¢jsä»£ç é˜»å¡ï¼Œæ‰€ä»¥Node.jså¯ä»¥å•æœåŠ¡å™¨æ‰¿æ‹…å¤§é‡çš„å¹¶å‘è¿æ¥ã€‚",e.jsx("br",{}),e.jsx("strong",{children:"å®ƒæœ€ç‰¹åˆ«çš„ä¼˜åŠ¿å°±æ˜¯å‰ç«¯åŒå­¦ä»¬ğŸ‘¨â€ğŸ’»ğŸ‘©â€ğŸ’»éƒ½ç†Ÿjsï¼Œä¸éœ€è¦å­¦ä¹ æ–°è¯­è¨€å°±å¯ä»¥å†™æœåŠ¡ç«¯çš„ä»£ç ã€‚åªéœ€è¦å‡ è¡Œä»£ç å°±å¯ä»¥å¯åŠ¨ä¸€ä¸ªæœåŠ¡ï¼Œå¦‚ä¸‹"}),e.jsx("iframe",{src:"https://codesandbox.io/embed/relaxed-shaw-5u3725?fontsize=14&hidenavigation=1&theme=dark",style:{width:"100%",height:"500px",border:0,borderRadius:"4px",overflow:"hidden",margin:"10px 0"},title:"relaxed-shaw-5u3725",allow:"accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking",sandbox:"allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"}),e.jsx("br",{}),"Node.jsæ ¸å¿ƒä¾èµ–é¡¹å¦‚ä¸‹ï¼š",e.jsx("br",{}),e.jsx("strong",{children:"ç±»åº“"}),"ï¼š",e.jsxs("ul",{className:s.ul,children:[e.jsxs("li",{children:[e.jsx("code",{children:e.jsx("a",{className:s.href,target:"_blank",rel:"noreferrer",href:"https://v8.dev/docs/",children:"V8"})}),"ï¼šV8ä¸ºNode.jsæä¾›äº†JavaScriptå¼•æ“ï¼ŒNode.jsé€šè¿‡V8 C++çš„APIå‡½æ•°æ¥å£è¿›è¡Œæ“æ§ã€‚V8ç”±è°·æ­Œç»´æŠ¤ï¼Œç”¨äºè°·æ­Œæµè§ˆå™¨ä¸­ã€‚"]}),e.jsxs("li",{children:[e.jsx("code",{children:e.jsx("a",{className:s.href,target:"_blank",rel:"noreferrer",href:"http://docs.libuv.org/",children:"libuv"})}),"ï¼šå®ƒæ˜¯Cè¯­è¨€çš„ç±»åº“ï¼Œç”¨äºéé˜»å¡å‹çš„I/Oæ“ä½œï¼ŒåŒæ—¶åœ¨æ‰€æœ‰æ”¯æŒçš„æ“ä½œç³»ç»Ÿä¸Šä¿æŒä¸€è‡´çš„æ¥å£ã€‚å®ƒæä¾›äº†ä¸€äº›æœºåˆ¶æ¥å¤„ç†æ–‡ä»¶ç³»ç»Ÿã€DNSã€ç½‘ç»œã€å­è¿›ç¨‹ã€ç®¡é“ã€ä¿¡å·é‡æ§åˆ¶ã€è½®è¯¢æœºåˆ¶å’Œæ•°æ®æµã€‚å®ƒä¹Ÿæä¾›äº†ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œç”¨äºæ— æ³•åœ¨æ“ä½œç³»ç»Ÿå±‚é¢è¿›è¡Œå¼‚æ­¥æ“ä½œçš„ä»»åŠ¡å¸è½½ã€‚"]}),e.jsxs("li",{children:[e.jsx("code",{children:e.jsx("a",{className:s.href,target:"_blank",rel:"noreferrer",href:"https://github.com/nodejs/llhttp",children:"llhttp"})}),"ï¼šç”±Cç¼–å†™ï¼Œç”¨äºHTTPè§£æã€‚"]}),e.jsxs("li",{children:[e.jsx("code",{children:e.jsx("a",{className:s.href,target:"_blank",rel:"noreferrer",href:"https://c-ares.haxx.se/docs.html",children:"c-ares"})}),"ï¼šå¼‚æ­¥DNSè¯·æ±‚"]}),e.jsxs("li",{children:[e.jsx("code",{children:e.jsx("a",{className:s.href,target:"_blank",rel:"noreferrer",href:"https://www.openssl.org/docs/",children:"OpenSSL"})}),"ï¼šåœ¨",e.jsx("code",{children:"tls"}),"å’Œ",e.jsx("code",{children:"crypto"}),"æ¨¡å—ä¸­ä½¿ç”¨ï¼Œå®ƒæä¾›äº†å¯†ç å‡½æ•°ã€‚"]}),e.jsxs("li",{children:[e.jsx("code",{children:e.jsx("a",{className:s.href,target:"_blank",rel:"noreferrer",href:"https://www.zlib.net/manual.html",children:"zlib"})}),"ï¼šNode.jsä½¿ç”¨zlibåˆ›å»ºåŒæ­¥ã€å¼‚æ­¥å’Œæ•°æ®æµå‹ç¼©ã€è§£å‹ç¼©æ¥å£ã€‚"]})]}),e.jsx("strong",{children:"å·¥å…·"}),"ï¼š",e.jsxs("ul",{className:s.ul,children:[e.jsxs("li",{children:[e.jsx("code",{children:e.jsx("a",{className:s.href,target:"_blank",rel:"noreferrer",href:"https://docs.npmjs.com/",children:"npm"})}),"ï¼šNode.jsçš„åŒ…ç®¡ç†å™¨ã€‚"]}),e.jsxs("li",{children:[e.jsx("code",{children:e.jsx("a",{className:s.href,target:"_blank",rel:"noreferrer",href:"https://gyp.gsrc.io/docs/UserDocumentation.md",children:"gyp"})}),"ï¼šä»V8æ‹·è´è€Œæ¥ï¼ŒåŸºäºpythonçš„é¡¹ç›®ç”Ÿæˆå·¥å…·ã€‚å®ƒå¯ä»¥ç”Ÿæˆè·¨å¹³å°çš„é¡¹ç›®æ–‡ä»¶ã€‚"]}),e.jsxs("li",{children:[e.jsx("code",{children:e.jsx("a",{className:s.href,target:"_blank",rel:"noreferrer",href:"https://code.google.com/p/googletest/wiki/V1_7_Documentation",children:"gtest"})}),"ï¼šC/C++ç¨‹åºæµ‹è¯•å·¥å…·ã€‚"]})]}),e.jsx("br",{}),"é‚£ä¹ˆè¿™äº›æŠ€æœ¯æ˜¯å¦‚ä½•ç»„åˆçš„å‘¢ï¼Ÿå¦‚ä¸‹æ˜¯node.jsçš„æ¶æ„å›¾",e.jsx(l,{src:d}),e.jsxs("ul",{className:s.ul,children:[e.jsx("li",{children:"æœ€ä¸Šå±‚æ˜¯Node APIï¼Œå¯ä»¥ç›´æ¥jsè°ƒç”¨"}),e.jsxs("li",{children:["ä¸­é—´",e.jsx("code",{children:"node bindings"}),"ï¼Œjsé€šè¿‡å®ƒå¯ä»¥å’ŒC/C++é€šä¿¡"]}),e.jsx("li",{children:"æœ€åº•å±‚å‘node bindingsæä¾›apiæœåŠ¡"})]}),e.jsx("h2",{id:"bindings",className:s.articleTitle,children:"Node bindings"}),"C/C++æœ‰å¾ˆå¤šåŠŸèƒ½jsæ˜¯æ²¡æœ‰çš„ï¼Œä¾‹å¦‚æ–‡ä»¶ç³»ç»Ÿï¼Œhttpç­‰ï¼Œä½†jsä¸èƒ½ç›´æ¥è°ƒç”¨C++çš„åº“ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªä¸­é—´äººï¼ŒNode bindingså°±æ˜¯è¿™ä¸ªä¸­é—´äººã€‚",e.jsx("br",{}),"Node.jsæ˜¯è¿™æ ·å¤„ç†çš„ï¼š",e.jsxs("ul",{className:s.ul,children:[e.jsx("li",{children:"å°†åº“ç”¨C++å°è£…ï¼Œæ–‡ä»¶ç±»å‹ä¸ºxxx.cpp"}),e.jsx("li",{children:"ç¼–è¯‘ä¸º.nodeæ–‡ä»¶"}),e.jsxs("li",{children:["jså¯ä»¥ç›´æ¥",e.jsx("code",{children:"require"}),"è¿™ä¸ª",e.jsx("code",{children:".node"}),"æ–‡ä»¶"]})]}),"ç¤ºä¾‹ä»£ç è§",e.jsx("a",{className:s.href,target:"_blank",rel:"noreferrer",href:"https://github.com/nodejs/node-addon-examples",children:"Node.js C++ addon examples å®˜æ–¹ç¤ºä¾‹ä»“åº“"}),"ï¼Œæ‹‰åˆ°æœ¬åœ°ä»hello worldå¼€å§‹çœ‹",e.jsx("br",{}),e.jsx("br",{}),e.jsx(l,{src:a}),e.jsx("h2",{id:"v8",className:s.articleTitle,children:"V8"}),e.jsx("code",{children:"V8"}),"æ˜¯è°·æ­Œå¼€æºçš„é«˜æ€§èƒ½jså¼•æ“ï¼Œç”¨C++å†™çš„ï¼ŒåŠŸèƒ½å¦‚ä¸‹",e.jsxs("ul",{className:s.ul,children:[e.jsx("li",{children:"ç¼–è¯‘å¹¶è¿è¡Œjsä»£ç "}),e.jsx("li",{children:"ç®¡ç†å†…å­˜"}),e.jsx("li",{children:"åƒåœ¾æ”¶é›†"}),e.jsx("li",{children:"å®ç°ECMAæ ‡å‡†ä¸­çš„ç±»å‹ã€è¿ç®—ç¬¦ã€å¯¹è±¡å’Œå‡½æ•°"})]}),e.jsx("h2",{id:"libuv",className:s.articleTitle,children:"libuv"}),"libuvæ˜¯ä¸€ä¸ªCåº“ï¼Œå®ƒæ”¯æŒå¤šå¹³å°çš„å¼‚æ­¥I/Oæ“ä½œï¼Œå•¥æ˜¯I/Oï¼Ÿ",e.jsxs("ul",{className:s.ul,children:[e.jsx("li",{children:"æ–‡ä»¶"}),e.jsx("li",{children:"ç½‘ç»œ"}),e.jsx("li",{children:"çº¿ç¨‹æ± "}),e.jsx("li",{children:"...æ›´å¤šï¼Œå¦‚ä¸‹å›¾"})]}),e.jsx(l,{src:o}),e.jsx("h2",{id:"workflow",className:s.articleTitle,children:"å·¥ä½œæµç¨‹"}),e.jsx(l,{src:t}),e.jsx("br",{}),"ä»¥è¯»å–æ–‡ä»¶ä¸ºä¾‹ï¼š",e.jsxs("ul",{className:s.ul,children:[e.jsxs("li",{children:[e.jsx("code",{children:"Application"}),"å°±æ˜¯ä»£ç ï¼Œç„¶å",e.jsx("code",{children:"V8è¿è¡Œä»£ç "})]}),e.jsxs("li",{children:["è¿è¡Œä»£ç åˆ°éœ€è¦è¯»å–æ–‡ä»¶ï¼Œ",e.jsx("code",{children:"libuv"}),"å¼€ä¸€ä¸ªçº¿ç¨‹è¯»æ–‡ä»¶"]}),e.jsxs("li",{children:["è¯»å®Œæ–‡ä»¶åï¼Œæ“ä½œç³»ç»Ÿè¿”å›äº‹ä»¶ç»™",e.jsx("code",{children:"event loop"}),"ï¼Œ",e.jsx("code",{children:"event loop"}),"æŠŠæ–‡ä»¶ä¼ å›ç»™",e.jsx("code",{children:"V8"})]})]}),e.jsx("h3",{id:"eventLoop",className:s.articleSubTitle,children:"äº‹ä»¶å¾ªç¯(Event Loop)"}),"å®ƒæ˜¯Node.jså¤„ç†éé˜»å¡I/Oæ“ä½œçš„æœºåˆ¶ï¼Œä¼šæŠŠæ“ä½œè½¬ç§»åˆ°ç³»ç»Ÿå†…æ ¸ä¸­å»ã€‚jsæ˜¯å•çº¿ç¨‹æ²¡é”™ï¼Œä½†æ˜¯å¤§å¤šæ•°ç³»ç»Ÿå†…æ ¸éƒ½æ˜¯å¤šçº¿ç¨‹çš„ï¼Œå®ƒä»¬å¯ä»¥åœ¨åå°å¤„ç†å¤šç§æ“ä½œï¼Œå½“ä¸€ä¸ªæ“ä½œå®Œæˆçš„æ—¶å€™ï¼Œå†…æ ¸é€šçŸ¥Node.jså°†åˆé€‚çš„å›è°ƒå‡½æ•°æ·»åŠ åˆ°é˜Ÿåˆ—é‡Œç­‰å¾…æ—¶æœºæ‰§è¡Œã€‚",e.jsx("br",{}),e.jsx("br",{}),"å½“Node.jså¯åŠ¨åï¼Œå®ƒä¼šåˆå§‹åŒ–",e.jsx("code",{children:"Event Loop"}),"ï¼Œå¤„ç†å·²æä¾›çš„è¾“å…¥è„šæœ¬ï¼Œå®ƒå¯èƒ½ä¼šè°ƒç”¨ä¸€äº›å¼‚æ­¥çš„APIã€è°ƒåº¦å®šæ—¶å™¨ï¼Œæˆ–è€…è°ƒç”¨",e.jsx("code",{children:"process.nextTick"}),"ï¼Œç„¶åå¼€å§‹å¤„ç†",e.jsx("code",{children:"Event Loop"}),"ï¼Œæµç¨‹å¦‚ä¸‹ï¼Œå®ƒå±•ç¤ºäº†æ“ä½œé¡ºåºçš„ç®€åŒ–æ¦‚è§ˆï¼š",i,e.jsx("div",{className:s.assist,children:"æ¯ä¸ªæ¡†éƒ½æ˜¯äº‹ä»¶å¾ªç¯æœºåˆ¶çš„ä¸€ä¸ªé˜¶æ®µã€‚"}),e.jsx("br",{}),"æ¯ä¸ªé˜¶æ®µéƒ½æœ‰ä¸€ä¸ªFIFOé˜Ÿåˆ—æ¥æ‰§è¡Œå›è°ƒã€‚è™½ç„¶æ¯ä¸ªé˜¶æ®µéƒ½æ˜¯ç‰¹æ®Šçš„ï¼Œä½†é€šå¸¸æƒ…å†µä¸‹ï¼Œå½“äº‹ä»¶å¾ªç¯è¿›å…¥ç»™å®šçš„é˜¶æ®µæ—¶ï¼Œå®ƒå°†æ‰§è¡Œç‰¹å®šäºè¯¥é˜¶æ®µçš„ä»»ä½•æ“ä½œï¼Œç„¶åä¹‹å¿ƒè¯¥é˜¶æ®µé˜Ÿåˆ—ä¸­çš„å›è°ƒï¼Œç›´åˆ°é˜Ÿåˆ—ç”¨å°½æˆ–å·²æ‰§è¡Œåˆ°æœ€å¤§çš„å›è°ƒæ•°ã€‚å½“æ‰§è¡Œå®Œæˆåï¼Œäº‹ä»¶å¾ªç¯å°†ç§»åŠ¨åˆ°ä¸‹ä¸€é˜¶æ®µï¼Œä»¥æ­¤ç±»æ¨ã€‚",e.jsx("br",{}),e.jsx("br",{}),e.jsx("h3",{id:"stage",className:s.articleSubTitle,children:"é˜¶æ®µæ¦‚è¿°"}),e.jsxs("ul",{className:s.ul,children:[e.jsxs("li",{children:[e.jsx("strong",{children:"timers(è®¡æ—¶å™¨)"}),"ï¼šæœ¬é˜¶æ®µæ‰§è¡Œå·²ç»è¢«",e.jsx("code",{children:"setTimeout"}),"å’Œ",e.jsx("code",{children:"setInterval"}),"çš„è°ƒåº¦å›è°ƒå‡½æ•°ã€‚",e.jsx("br",{}),e.jsx("br",{}),"è®¡æ—¶å™¨å¯ä»¥æŒ‡å®šé˜ˆå€¼ï¼Œè€Œä¸æ˜¯ç”¨æˆ·å¸Œæœ›å›è°ƒæ‰§è¡Œçš„ç¡®åˆ‡æ—¶é—´ã€‚ç»è¿‡æŒ‡å®šçš„æ—¶é—´é—´éš”åï¼Œè®¡æ—¶å™¨å›è°ƒå°†è¢«å°½å¯èƒ½æ—©åœ°è¿è¡Œï¼Œä½†æ˜¯æ“ä½œç³»ç»Ÿè°ƒåº¦æˆ–å…¶ä»–æ­£åœ¨è¿è¡Œçš„å›è°ƒå¯èƒ½ä¼šå»¶è¿Ÿå®ƒä»¬ (ç”±è½®è¯¢é˜¶æ®µæ§åˆ¶)ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œè®¾ç½®äº†ä¸€ä¸ª100msçš„å®šæ—¶å™¨ï¼Œå‡è®¾è¯»å–æ–‡ä»¶éœ€è¦95msï¼š",c,"å½“äº‹ä»¶å¾ªç¯è¿›å…¥pollé˜¶æ®µæ—¶ï¼Œå®ƒç”±ä¸€ä¸ªç©ºé˜Ÿåˆ—ï¼ˆæ­¤æ—¶",e.jsx("code",{children:"fs.readFile"}),"æš‚æœªå®Œæˆï¼‰ï¼Œå› æ­¤å®ƒå°†ç­‰å¾…å‰©ä¸‹çš„æ¯«ç§’æ•°ï¼Œç›´åˆ°è¾¾åˆ°æœ€å¿«çš„ä¸€ä¸ªè®¡æ—¶å™¨é˜ˆå€¼ä¸ºæ­¢ã€‚å½“å®ƒç­‰å¾…95msåï¼Œ",e.jsx("code",{children:"fs.readFile"}),"å®Œæˆï¼Œå®ƒçš„é‚£ä¸ªéœ€è¦10æ¯«ç§’æ‰èƒ½å®Œæˆçš„å›è°ƒå°†è¢«æ·»åŠ åˆ°è½®è¯¢é˜Ÿåˆ—ä¸­å¹¶æ‰§è¡Œã€‚å½“å›è°ƒå®Œæˆåï¼Œé˜Ÿåˆ—ä¸ºç©ºï¼Œæ­¤æ—¶äº‹ä»¶å¾ªç¯æœºåˆ¶å‘ç°è®¡æ—¶å™¨æœ€å¿«çš„é˜ˆå€¼(100ms)å·²è¾¾åˆ°ï¼Œå°†å›åˆ°è®¡æ—¶å™¨é˜¶æ®µï¼Œæ‰§è¡Œè®¡æ—¶å™¨é˜¶æ®µã€‚"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"I/O callbacks(å¾…å®šå›è°ƒ)"}),"ï¼šæ‰§è¡Œå»¶è¿Ÿåˆ°ä¸‹ä¸€ä¸ªå¾ªç¯è¿­ä»£çš„I/Oå›è°ƒ",e.jsx("br",{}),e.jsx("br",{}),"æ­¤é˜¶æ®µå¯¹æŸäº›ç³»ç»Ÿæ“ä½œï¼ˆå¦‚TCPé”™è¯¯ç±»å‹ï¼‰æ‰§è¡Œå›è°ƒã€‚"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"idle,prepare"}),"ï¼šä»…ç³»ç»Ÿå†…éƒ¨ä½¿ç”¨"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"poll(è½®è¯¢)"}),"ï¼šæ£€ç´¢æ–°çš„I/Oäº‹ä»¶ï¼›æ‰§è¡Œä¸I/Oç›¸å…³çš„å›è°ƒï¼ˆé™¤äº†å…³é—­çš„å›è°ƒå‡½æ•°ã€è®¡æ—¶å™¨å’Œ",e.jsx("code",{children:"setImmediate"}),"è°ƒåº¦çš„ä¹‹å¤–ï¼‰ï¼Œå…¶ä½™æƒ…å†µnodeå°†åœ¨é€‚å½“çš„æ—¶å€™åœ¨æ­¤é˜»å¡ã€‚",e.jsx("br",{}),e.jsx("br",{}),"è½®è¯¢é˜¶æ®µæœ‰ä¸¤ä¸ªé‡è¦çš„åŠŸèƒ½ï¼š",e.jsxs("ul",{children:[e.jsx("li",{children:"1. è®¡ç®—åº”è¯¥é˜»å¡å’Œè½®è¯¢I/Oçš„æ—¶é—´"}),e.jsx("li",{children:"2. å¤„ç†è½®è¯¢é˜Ÿåˆ—é‡Œçš„æ—¶é—´"})]}),"å½“æ—¶é—´å¾ªç¯è¿›å…¥è½®è¯¢é˜¶æ®µä¸”æ²¡æœ‰è¢«è°ƒåº¦çš„è®¡æ—¶å™¨æ—¶ï¼Œå°†å‘ç”Ÿä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š",e.jsxs("ul",{className:s.ul,children:[e.jsx("li",{children:"å¦‚æœè½®è¯¢é˜Ÿåˆ—ä¸æ˜¯ç©ºçš„ï¼Œäº‹ä»¶å¾ªç¯å°†å¾ªç¯è®¿é—®å›è°ƒé˜Ÿåˆ—å¹¶åŒæ­¥æ‰§è¡Œå®ƒä»¬ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸ºç©ºï¼Œæˆ–è€…è¾¾åˆ°ç³»ç»Ÿç¡¬æ€§é™åˆ¶"}),e.jsxs("li",{children:["å¦‚æœè½®è¯¢é˜Ÿåˆ—æ˜¯ç©ºçš„ï¼š",e.jsxs("ul",{className:s.ul,children:[e.jsxs("li",{children:["å¦‚æœè„šæœ¬è¢«",e.jsx("code",{children:"setImmediate"}),"è°ƒåº¦ï¼Œåˆ™æ—¶é—´å¾ªç¯å°†ç»“æŸè½®è¯¢é˜¶æ®µï¼Œç»§ç»­æ‰§è¡Œæ£€æŸ¥é˜¶æ®µ"]}),e.jsx("li",{children:"å¦åˆ™ç­‰å¾…å›è°ƒè¢«æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­å¹¶ç«‹å³æ‰§è¡Œ"})]})]})]}),"ä¸€æ—¦è½®è¯¢é˜Ÿåˆ—ä¸ºç©ºï¼Œäº‹ä»¶å¾ªç¯å°†æ£€æŸ¥å·²è¾¾åˆ°æ—¶é—´é˜ˆå€¼çš„è®¡æ—¶å™¨ã€‚å¦‚æœæœ‰è®¡æ—¶å™¨å·²å‡†å¤‡å°±ç»ªï¼Œåˆ™äº‹ä»¶å¾ªç¯å°†ç»•å›è®¡æ—¶å™¨é˜¶æ®µæ‰§è¡Œè¿™äº›è®¡æ—¶å™¨çš„å›è°ƒã€‚"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"check(æ£€æŸ¥)"}),"ï¼š",e.jsx("code",{children:"setImmediate"}),"å›è°ƒå‡½æ•°åœ¨è¿™é‡Œæ‰§è¡Œ",e.jsx("br",{}),e.jsx("br",{}),"æ­¤é˜¶æ®µå…è®¸åœ¨è½®è¯¢é˜¶æ®µå®Œæˆåç«‹å³æ‰§è¡Œå›è°ƒã€‚å¦‚æœè½®è¯¢é˜¶æ®µå˜ä¸ºç©ºé—²çŠ¶æ€ï¼Œå¹¶ä¸”è„šæœ¬ä½¿ç”¨",e.jsx("code",{children:"setImmediate"}),"åè¢«æ’åˆ—åœ¨é˜Ÿåˆ—ä¸­ï¼Œåˆ™äº‹ä»¶å¾ªç¯å¯èƒ½åˆ°æ£€æŸ¥é˜¶æ®µè€Œä¸æ˜¯ç­‰å¾…ã€‚",e.jsx("br",{}),e.jsx("code",{children:"setImmediate"}),"å®é™…ä¸Šæ˜¯ä¸€ä¸ªåœ¨äº‹ä»¶å¾ªç¯çš„å•ç‹¬é˜¶æ®µè¿è¡Œçš„ç‰¹æ®Šè®¡æ—¶å™¨ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªlibuv APIæ¥å®‰æ’å›è°ƒåœ¨è½®è¯¢é˜¶æ®µå®Œæˆåæ‰§è¡Œã€‚",e.jsx("br",{}),"é€šå¸¸åœ¨æ‰§è¡Œä»£ç æ—¶ï¼Œäº‹ä»¶å¾ªç¯æœ€ç»ˆä¼šè¿›å…¥è½®è¯¢é˜¶æ®µã€‚ä½†æ˜¯å¦‚æœå›è°ƒå·²ä½¿ç”¨",e.jsx("code",{children:"setImmediate"}),"è°ƒåº¦è¿‡ï¼Œå¹¶ä¸”è½®è¯¢é˜¶æ®µå˜ä¸ºç©ºé—²çŠ¶æ€ï¼Œç»§ç»­åˆ°æ£€æŸ¥é˜¶æ®µã€‚"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"close callbacks(å…³é—­çš„å›è°ƒå‡½æ•°)"}),"ï¼›ä¸€äº›å…³é—­çš„å›è°ƒå‡½æ•°ï¼Œå¦‚",e.jsx("code",{children:'socket.on("close",...)'}),e.jsx("br",{}),e.jsx("br",{}),"å¦‚æœsocketæˆ–å¤„ç†å‡½æ•°çªç„¶å…³é—­(ä¾‹å¦‚socket.destroy),åˆ™",e.jsx("code",{children:"close"}),"äº‹ä»¶å°†åœ¨è¿™ä¸ªé˜¶æ®µå‘å‡ºï¼Œå¦åˆ™é€šè¿‡",e.jsx("code",{children:"process.nextTick"}),"å‘å‡ºã€‚"]})]})]}),e.jsx(n,{items:[{title:"Node.js",key:"intro",href:"#intro"},{title:"Node bindings",key:"bindings",href:"#bindings"},{title:"V8",key:"v8",href:"#v8"},{title:"libuv",key:"libuv",href:"#libuv"},{title:"å·¥ä½œæµç¨‹",key:"å·¥ä½œæµç¨‹",href:"#workflow",children:[{title:"äº‹ä»¶å¾ªç¯(Event Loop)",key:"eventLoop",href:"#eventLoop"},{title:"é˜¶æ®µæ¦‚è¿°",key:"stage",href:"#stage"}]}]})]})}export{p as default};
