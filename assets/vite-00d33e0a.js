import{j as e,d as s,e as r}from"./index-298bb257.js";import{V as i}from"./index-44434083.js";import{U as l}from"./useMarkdown-3461f6cc.js";import{A as t}from"./Anchor-c8fc4162.js";import"./index-6c3c40ca.js";const c="/luoyunlai/assets/vite-51249ca9.png",a="/luoyunlai/assets/vite-adv-1-a81c93b3.png",n="/luoyunlai/assets/vite-adv-2-26360cd6.png",d="/luoyunlai/assets/vite-adv-3-fe78130a.png",x="/luoyunlai/assets/max-age-1cf213af.png",j="/luoyunlai/assets/vite-deps-998aaf74.png",o="/luoyunlai/assets/vite-resource-85e66b4b.png",h=[{key:"h1",href:"#h1",title:"Vite"},{key:"1",href:"#front",title:"å‰è¨€"},{key:"2",href:"#begin",title:"ä¼˜ç‚¹",children:[{key:"3",href:"#no-build",title:"æ— éœ€æ‰“åŒ…"},{key:"4",href:"#hmr",title:"çƒ­é‡è½½(HMR)"}]},{key:"5",href:"#move",title:"è¿ç§»æµç¨‹"},{key:"6",href:"#end",title:"æŠ€æœ¯é€‰å‹",children:[{key:"7",href:"#rollup",title:"Rollup"},{key:"8",href:"#webpack",title:"Webpack"},{key:"9",href:"#vite",title:"Vite"},{key:"10",href:"#turbopack",title:"Turbopack"}]}];function k(){return e.jsxs("article",{id:"rootArticle",className:s.article,children:[e.jsxs("main",{className:s.content,children:[e.jsxs("h1",{id:"h1",className:s.pageTitle,children:["2022å¹´è¿˜åœ¨ç”¨webpack?å¿«ä¸Š",e.jsx("a",{className:"text-blue",target:"_blank",rel:"noreferrer",href:"https://cn.vitejs.dev/",children:"Viteï¼"})]}),e.jsx("br",{}),e.jsx(r,{src:c,alt:"VITE",width:320,height:320}),e.jsx("h2",{id:"front",className:s.articleTitle,children:"å‰è¨€"}),e.jsxs("p",{children:["æœ¬ä»“åº“æœ€å¼€å§‹æ˜¯ç”± ",e.jsx("code",{children:"create-react-app"})," ","åˆ›å»ºï¼Œå…¶ä¸­ä½¿ç”¨äº†webpackï¼Œå…³äºwebpackæˆ‘æœ‰å‡ ç‚¹æƒ³åæ§½"]}),e.jsxs("ul",{className:s.ul,children:[e.jsx("li",{children:"1.çƒ­æ›¿æ¢é€Ÿåº¦æ…¢ï¼Œå†™å®Œå‡ è¡Œä»£ç éšæ‰‹ä¿å­˜æƒ³çœ‹çœ‹æ•ˆæœï¼Œéœ€è¦ç­‰ä¸ªå‡ ç§’æ‰èƒ½çœ‹åˆ°ã€‚"}),e.jsx("li",{children:"2.å·¥ç¨‹è§„æ¨¡å˜å¤§åï¼Œå¯åŠ¨é€Ÿåº¦æ˜¾è‘—å˜æ…¢ã€‚"}),e.jsx("li",{children:"3.é…ç½®å¤§è€Œå¤æ‚ï¼Œä¸ç”¨vue-cli/umi/creatReactAppè¿™ç§é›†å¤§æˆè€…é«˜ä½ä¹Ÿå¾—æ¥ä¸ªå‡ åè¡Œä»£ç æ‰èƒ½è¾¾åˆ°æœ€ä½³çŠ¶æ€"})]}),e.jsx("h2",{id:"begin",className:s.articleTitle,children:"ä¼˜ç‚¹"}),e.jsx("p",{children:"æ‰€ä»¥è‡³å°‘åœ¨æœ¬åœ°å¼€å‘é˜¶æ®µæˆ–è€…ä»…é¢å‘ç°ä»£æµè§ˆå™¨çš„å·¥ç¨‹ï¼Œå¯ä»¥å¤§èƒ†ä½¿ç”¨viteæ¥åŠ é€Ÿã€‚é‚£ä¹ˆå®ƒä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«å‘¢ï¼Ÿä¸»è¦æœ‰ä»¥ä¸‹ä¸¤æ–¹é¢åŸå› "}),e.jsxs("ul",{className:`${s.ul} list-none`,children:[e.jsxs("li",{children:[e.jsx(r,{src:a,alt:"adv1"}),e.jsxs("div",{className:"pl-10",children:[e.jsx("br",{}),e.jsx("strong",{id:"no-build",children:"æ— éœ€æ‰“åŒ…"}),"ï¼šå‡†ç¡®çš„è¯´æ˜¯ä¸ç”¨jså†™çš„æ‰“åŒ…å™¨å…¨é‡æ‰“åŒ…ğŸ¤ª ",e.jsx("br",{}),e.jsx("br",{}),"1. viteä¼šç›´æ¥å¯åŠ¨æœåŠ¡ï¼Œå¹¶ä¸”è¿›è¡Œé¢„æ„å»ºä¾èµ–ã€‚å…·ä½“è¡¨ç°ä¸ºå¯¹ä»£ç è¿›è¡Œå¯¼å…¥åˆ†æï¼Œä½¿ç”¨",e.jsx("strong",{children:"esbuild"}),"å°†CJSæˆ–UMDä¾èµ–å…¨éƒ¨è½¬æ¢ä¸ºESMç¼“å­˜åˆ°node_modules/.vite/depsç›®å½•ä¸‹ï¼Œåç»­ç›´æ¥ä»ç¼“å­˜è·å–ã€‚",e.jsx(r,{src:j,alt:"deps"}),e.jsx("br",{}),"esbuildæ˜¯ç”¨goç¼–å†™çš„ï¼Œé€Ÿåº¦æ¯”jså¿«10-100å€ï¼Œå› ä¸ºgoå¯¹å¤šçº¿ç¨‹çš„æ”¯æŒæ¯”jså¥½ï¼Œæ”¯æŒå…±äº«å†…å­˜ï¼ˆå°½é‡å¤ç”¨ASTï¼‰ï¼Œè€Œä¸”esbuildæ‰€æœ‰ä»£ç éƒ½æ˜¯è‡ªè¡Œç¼–å†™ã€‚jsè®¾è®¡å­˜åœ¨å¤šçº¿ç¨‹/ç¼–è¯‘æ–¹é¢çš„ç¼ºé™·ã€‚",e.jsx("br",{}),"viteæä¾›çš„æ˜¯ESMçš„æºç ï¼Œåˆ©ç”¨äº†æµè§ˆå™¨å¯¹ESMçš„æ”¯æŒï¼Œå°†éƒ¨åˆ†æ‰“åŒ…ç¨‹åºçš„å·¥ä½œäº¤ç»™äº†æµè§ˆå™¨ï¼Œå¯¹äºESMä¸éœ€è¦ç±»ä¼¼äºwebpackçš„èƒ¶æ°´ä»£ç ã€‚å¹¶ä¸”viteç»™ä¸å¸¸å˜åŒ–çš„ä¾èµ–è¯·æ±‚åŠ ä¸Šäº†é•¿æœŸå¼ºç¼“å­˜ã€‚",e.jsx(r,{src:x,alt:"max-age"}),e.jsx("br",{}),e.jsx("br",{}),"è€Œwebpackéœ€è¦å…¨é‡æ‰“åŒ…ï¼Œå¹¶ä¸”åœ¨æ„å»ºä¾èµ–æ—¶éœ€è¦ç»è¿‡å¤šä¸ªloaderè¿›è¡Œå­—ç¬¦ä¸²çš„å¤„ç†ï¼Œå°¤å…¶æ˜¯babel-loaderæ¶‰åŠåˆ°å¤šæ¬¡å­—ç¬¦ä¸²ASTäº’è½¬çš„æ“ä½œã€‚Webpack æ‰“åŒ…æ—¶é—´ = parse string * n + transform * n + parse to AST + compress",e.jsx("br",{})," ",e.jsx("br",{})," 2. å¯åŠ¨æœåŠ¡åï¼Œæ ¹æ®è·¯ç”±ï¼Œé€šè¿‡httpè¯·æ±‚æ¥è·å–æ–‡ä»¶å’ŒåŠ è½½æ‰€éœ€æ¨¡å—ã€‚ï¼ˆå¦‚æœæ¨¡å—è¿‡å¤šä¼šå—æµè§ˆå™¨httpæœ€å¤§å¹¶è¡Œæ•°é™åˆ¶,viteé¦–æ¬¡å¯åŠ¨æ…¢å…¶ä¸­ä¹‹ä¸€æ˜¯è¿™ä¸ªåŸå› ï¼‰ä¸‹å›¾æ˜¯æœ¬è·¯ç”±çš„èµ„æºåˆ—è¡¨",e.jsx("br",{}),"å¯ä»¥çœ‹å‡ºviteå¯¹äºèµ„æºå¤„ç†çš„å¤§ä½“é€»è¾‘ï¼Œ index.html => å…¥å£ESM index.tsx => index.tsxä¸­å¯¼å…¥çš„å…¶ä»–æ¨¡å—",e.jsx(r,{src:o,alt:"resource"})]})]}),e.jsxs("li",{children:[e.jsx("br",{}),e.jsx("br",{}),e.jsx(r,{src:n,alt:"adv2"}),e.jsx("br",{}),e.jsx("strong",{id:"hmr",children:"çƒ­é‡è½½(HMR)"}),"Â  viteæ˜æ˜¾å¿«äºwebpackï¼Œè¿™ä¸ªè·Ÿå®ƒä»¬å„è‡ªçš„å®ç°æ–¹å¼æœ‰å…³ã€‚",e.jsx("br",{}),e.jsx("br",{}),"Webpack-dev-serverå®ç°hmrçš„æ–¹å¼æ˜¯ç›‘å¬åˆ°å˜åŒ–åï¼Œé€šè¿‡websocketæœåŠ¡ä¸»åŠ¨æ¨é€ï¼Œé¡µé¢éœ€è¦åˆ·æ–°ã€‚è€Œviteåªéœ€è¦é‡æ–°è¯·æ±‚å˜åŒ–çš„èµ„æºå³å¯"]}),e.jsxs("li",{children:[e.jsx("br",{}),e.jsx("br",{}),e.jsx(r,{src:d,alt:"adv3"}),e.jsx("br",{}),"vite buildä½¿ç”¨",e.jsx("strong",{children:"rollup"}),",rollupäº§å‡ºçš„åŒ…ä½“ç§¯å¤©ç„¶æ¯”webpackçš„è¦å°ï¼ŒåŸç”Ÿæ”¯æŒESMéå¸¸é€‚åˆç»„ä»¶åº“çš„å¼€å‘ï¼Œè€Œwebpackéœ€è¦æ³¨å…¥é¢å¤–èƒ¶æ°´ä»£ç ï¼Œå¤©ç„¶æœ‰ä½“ç§¯ä¸Šçš„åŠ£åŠ¿ã€‚"]})]}),e.jsx("h2",{id:"move",className:s.articleTitle,children:"è¿ç§»æµç¨‹"}),e.jsxs("ul",{className:s.ul,children:[e.jsxs("li",{children:["ä»create-react-appè¿ç§»",e.jsx("br",{}),e.jsx("br",{}),e.jsxs("p",{children:[e.jsx("code",{children:"pnpm add -D vite vite-tsconfig-paths"}),e.jsx("br",{}),e.jsx("br",{}),"ç„¶åå°†public/index.htmlç§»åŠ¨åˆ°æ ¹ç›®å½•ä¸‹ï¼Œå»æ‰%PUBLIC_URL%ï¼Œä¿®æ”¹scriptÂ ",e.jsx("code",{children:'<script type="module" src="/src/index.tsx"><\/script>'}),e.jsx("br",{}),e.jsx("br",{}),"ä¿®æ”¹package.jsonçš„startå’Œbuildå‘½ä»¤",e.jsx("br",{}),e.jsx("br",{}),e.jsxs("code",{children:['"start": "vite",',e.jsx("br",{}),'"build": "vite build"']}),e.jsx("br",{}),e.jsx("br",{}),"æ–°å¢Â ",e.jsx("code",{children:"vite.config.ts"}),e.jsx(l,{markdown:i}),e.jsx("br",{}),"å¤§åŠŸå‘Šæˆï¼Œå¯ä»¥pnpm startå¯åŠ¨äº†ï¼Œæœ€åç§»é™¤react-scriptsÂ ",e.jsx("code",{children:"pnpm remove react-scripts"})]})]}),e.jsx("li",{children:"umi4å¤©ç„¶æ”¯æŒ"})]}),e.jsx("h2",{id:"end",className:s.articleTitle,children:"æŠ€æœ¯é€‰å‹"}),"å¯ä»¥çœ‹å‡ºæœ¬æ–‡é‡å¤æœ€å¤šçš„å•è¯å°±æ˜¯ESMï¼Œviteçš„æ ¸å¿ƒç†å¿µå°±åœ¨äºæ­¤ï¼Œå……åˆ†çš„åˆ©ç”¨ç°ä»£æµè§ˆå™¨åŸç”Ÿæ”¯æŒESMã€‚",e.jsx("br",{}),e.jsxs("ul",{className:s.ul,children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Rollup"}),"æ›´é€‚åˆæ‰“åŒ…ç»„ä»¶åº“/æ’ä»¶(library)ã€‚å®ƒåŸºäºESMæ‰“åŒ…ï¼Œç”Ÿæˆçš„æ–‡ä»¶æ›´å°ï¼Œæ”¯æŒtree-shakingï¼Œä½†æ˜¯ä¸æ”¯æŒä»£ç åˆ†å‰²ã€‚"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Webpack"}),"æ›´é€‚åˆæ‰“åŒ…é¡¹ç›®ï¼Œå®ƒæ”¯æŒä»£ç åˆ†å‰²ï¼ŒdevServerçš„çƒ­æ›´æ–°ï¼Œä»¥åŠå„ç§loaderå’Œpluginæ¥å¤„ç†å„ç§æ–‡ä»¶ã€‚ä½†æ˜¯å®ƒçš„äº§ç‰©ä¼šæ³¨å…¥å¾ˆå¤šèƒ¶æ°´ä»£ç ï¼Œå¯¼è‡´ä½“ç§¯å¢åŠ ã€‚"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Vite"}),"æ›´é€‚åˆç°ä»£Webåº”ç”¨çš„å¼€å‘(æ”¯æŒESM)ï¼Œè¿½æ±‚å¼€å‘æ•ˆç‡å’Œæ€§èƒ½ä¼˜åŒ–çš„å¯ä»¥é€‰æ‹©Viteã€‚å¦‚æœé¡¹ç›®éœ€è¦ä¸€å®šå…¼å®¹æ€§ï¼Œä¸å¤ªé€‚åˆç”¨äºç”Ÿäº§æ‰“åŒ…ï¼Œå½“ç„¶ä¹Ÿæœ‰æ’ä»¶æ”¯æŒã€‚"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Turbopack"}),"å¾ˆæ–°ï¼Œå¾ˆå¿«ï¼Œä½¿ç”¨Rustç¼–å†™ï¼Œä½†æ˜¯å®ƒå¤„äºalphaé˜¶æ®µï¼Œæœªæ¥ç­‰ç¨³å®šäº†å†è€ƒè™‘ã€‚"]})]})]}),e.jsx(t,{items:h})]})}export{k as default};
